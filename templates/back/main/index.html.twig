{% extends 'base.html.twig' %}

{% block title %}Hello MainController!{% endblock %}

{% block body %}

<h1>Hello, world!</h1>

<div id="map" style="width: 100%; height: 400px;"></div>

{# Carte Leaflet #}
<script>
    //Appel et configuration carte
    var osmUrl = 'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
			osmAttrib = '&copy; <a href="http://openstreetmap.org/copyright">OpenStreetMap</a> contributors',
			osm = L.tileLayer(osmUrl, {maxZoom: 18, attribution: osmAttrib});

    var rotation = Math.PI/4;
    var map = L
        .map('map', {rotate: true})
        .setView([43.723185, -1.432222], 10)
        .addLayer(osm)
        // .setBearing("90")
    ;

    // map.on('mousemove', logMouse);

    // Fonds de carte

    // Ajout marqueurs
    var plages = new L.LayerGroup();

    let marker;
    let ordersNumber;
</script>

{% for key, marker in markers %}    
<script>
    marker = "{{ key|json_encode|trim('\"') }}".split(', ');
    ordersNumber = "{{ marker }}";

    console.log(marker);
    
    // Plages des casernes
    L.circle(marker, {
        color: 'red',
        fillColor: '#f03',
        fillOpacity: 0.5,
        radius: 100 * ordersNumber
    }).addTo(map);
    </script>
{% endfor %}

{% endblock %}

{% block stylesheets %}
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin="" />
{% endblock %}

{% block javascripts %}
<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>

{# <script src="assets/js/leaflet-src.js"></script> #}
{% endblock %}